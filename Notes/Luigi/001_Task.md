# Luigi task

Source: https://www.digitalocean.com/community/tutorials/how-to-build-a-data-processing-pipeline-using-luigi-in-python-on-ubuntu-20-04#step-2-creating-a-luigi-task

A Luigi task is where the execution of your pipeline and the definition of each taskâ€™s input and output dependencies take place. Tasks are the building blocks that you will create your pipeline from. You define them in a class, which contains:
* A `run()` method that holds the logic for executing the task.
* An `output()` method that returns the artifacts generated by the task. The run() method populates these artifacts.
* An optional `input()` method that returns any additional tasks in your pipeline that are required to execute the current task. The `run()` method uses these to carry out the task.

```python
import luigi

class HelloLuigi(luigi.Task):
    
    # def requires(self):
    #     return RequiredTask()
    
    def output(self):
        return luigi.LocalTarget('hello-luigi.txt')

    def run(self):
        with self.output().open("w") as outfile:
            outfile.write("Hello Luigi!")
```

You define that HelloLuigi() is a Luigi task by adding the luigi.Task mixin to it.

The output() method defines one or more Target outputs that your task produces. In the case of this example, you define a luigi.LocalTarget, which is a local file.

To execute the task you created, run the following command:

```commandline
python -m luigi --module hello-world HelloLuigi --local-scheduler
```

Here, you run the task using python -m instead of executing the luigi command directly; this is because Luigi can only execute code that is within the current PYTHONPATH. You can alternatively add PYTHONPATH='.' to the front of your Luigi command, like so:

```commandline
PYTHONPATH='.' luigi --module hello-world HelloLuigi --local-scheduler
```

With the `--module hello-world HelloLuigi` flag, you tell Luigi which Python module and Luigi task to execute.

The `--local-scheduler` flag tells Luigi to not connect to a Luigi scheduler and, instead, execute this task locally. Running tasks using the local-scheduler flag is only recommended for development work.
